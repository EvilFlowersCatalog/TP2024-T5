<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-design/repositories" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Glasskube Repositories | Team 5</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://opengraph.githubassets.com/3fbd03d4d860275ee154ca566f24ecce9243e229fe367523fbcab52e8b43db3f/glasskube/glasskube"><meta data-rh="true" name="twitter:image" content="https://opengraph.githubassets.com/3fbd03d4d860275ee154ca566f24ecce9243e229fe367523fbcab52e8b43db3f/glasskube/glasskube"><meta data-rh="true" property="og:url" content="https://EvilFlowersCatalog.dev/TP2024-T5/docs/design/repositories/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Glasskube Repositories | Team 5"><meta data-rh="true" name="description" content="Problem Analysis"><meta data-rh="true" property="og:description" content="Problem Analysis"><link data-rh="true" rel="icon" href="/TP2024-T5/img/favicon.png"><link data-rh="true" rel="canonical" href="https://EvilFlowersCatalog.dev/TP2024-T5/docs/design/repositories/"><link data-rh="true" rel="alternate" href="https://EvilFlowersCatalog.dev/TP2024-T5/docs/design/repositories/" hreflang="en"><link data-rh="true" rel="alternate" href="https://EvilFlowersCatalog.dev/TP2024-T5/docs/design/repositories/" hreflang="x-default"><link rel="preconnect" href="https://a.glasskube.eu/">
<script>var _paq=window._paq=window._paq||[];_paq.push(["setRequestMethod","POST"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),_paq.push(["enableHeartBeatTimer"]),function(){var e="https://a.glasskube.eu/";_paq.push(["setRequestMethod","POST"]),_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","5"]);var a=document,t=a.createElement("script"),p=a.getElementsByTagName("script")[0];t.type="text/javascript",t.async=!0,t.src=e+"matomo.js",p.parentNode.insertBefore(t,p)}()</script>

<link rel="alternate" type="application/rss+xml" href="/TP2024-T5/blog/rss.xml" title="Team 5 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/TP2024-T5/blog/atom.xml" title="Team 5 Atom Feed">


<link rel="preconnect" href="https://p.glasskube.eu">
<script>!function(t,e){var o,s,r,a;e.__SV||(window.posthog=e,e._i=[],e.init=function(p,i,n){function c(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(r=t.createElement("script")).type="text/javascript",r.async=!0,r.src=i.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(a=t.getElementsByTagName("script")[0]).parentNode.insertBefore(r,a);var g=e;for(void 0!==n?g=e[n]=[]:n="posthog",g.people=g.people||[],g.toString=function(t){var e="posthog";return"posthog"!==n&&(e+="."+n),t||(e+=" (stub)"),e},g.people.toString=function(){return g.toString(1)+".people (stub)"},o="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled onFeatureFlags getFeatureFlag getFeatureFlagPayload reloadFeatureFlags group updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures getActiveMatchingSurveys getSurveys onSessionId".split(" "),s=0;s<o.length;s++)c(g,o[s]);e._i.push([p,i,n])},e.__SV=1)}(document,window.posthog||[]),posthog.init("phc_EloQUW6cgfbTc0pI9c5CXElhQ4gVGRoBsrUAoakJVoQ",{api_host:"https://p.glasskube.eu",ui_host:"https://eu.posthog.com",id:"default"})</script><link rel="stylesheet" href="/TP2024-T5/assets/css/styles.3a49a472.css">
<script src="/TP2024-T5/assets/js/runtime~main.89cb1c4c.js" defer="defer"></script>
<script src="/TP2024-T5/assets/js/main.ba36cd88.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/TP2024-T5/"><div class="navbar__logo"><img src="/TP2024-T5/img/glasskube-logo.svg" alt="Glasskube Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/TP2024-T5/img/glasskube-logo.svg" alt="Glasskube Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Team 5</b></a><a class="navbar__item navbar__link" href="/TP2024-T5/blog/">Records</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/TP2024-T5/docs/">Sprints</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/TP2024-T5/docs/">Welcome</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/TP2024-T5/docs/getting-started/install/">Getting started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/TP2024-T5/docs/components/client/">Components</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/TP2024-T5/docs/integration/gitops/">Integration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/TP2024-T5/docs/design/dependency-management/">Design</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/TP2024-T5/docs/design/dependency-management/">Dependency Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/TP2024-T5/docs/design/package-config/">Package Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/TP2024-T5/docs/design/package-scopes/">Package Scopes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/TP2024-T5/docs/design/repositories/">Glasskube Repositories</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/TP2024-T5/docs/design/telemetry/">Telemetry</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/TP2024-T5/docs/reference/package-manifest/">Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/TP2024-T5/docs/comparisons/helm/">Comparisons</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><span class="breadcrumbs__link">Design</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Glasskube Repositories</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Glasskube Repositories</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="problem-analysis">Problem Analysis<a href="#problem-analysis" class="hash-link" aria-label="Direct link to Problem Analysis" title="Direct link to Problem Analysis">​</a></h2>
<p>In its current state, Glasskube only supports a single repository that is baked into the source code.
While there was an effort to support different repositories in the beginning, by providing a <code>RepositoryURL</code> field in the <code>PackageSpec</code>, it was never documented and is currently not functional.</p>
<p>Implementing support would provide multiple benefits:</p>
<ul>
<li>Support local repositories for use during package creation</li>
<li>Support users to manage their own packages without publishing them to the official repository</li>
</ul>
<p>The following challenges were identified during analysis and should be addressed by the proposed solution:</p>
<ul>
<li>Authentication must be supported. Basic and Bearer authentication (fixed token) should be sufficient to start with.</li>
<li>Provide authentication credentials via secret or directly</li>
<li>Packages are identified by name only, if there is a package with the same name in multiple repositories, the behavior should be documented, deterministic and obvious to the user.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="proposed-solution">Proposed Solution<a href="#proposed-solution" class="hash-link" aria-label="Direct link to Proposed Solution" title="Direct link to Proposed Solution">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="api-specification-and-operator">API Specification and Operator<a href="#api-specification-and-operator" class="hash-link" aria-label="Direct link to API Specification and Operator" title="Direct link to API Specification and Operator">​</a></h3>
<p>A list of available repositories is available in the cluster via a new CRD <code>PackageRepository</code>.
The <code>PackageRepository</code> could look something like this:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> packages.glasskube.dev/v1alpha1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> PackageRepository</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># PackageRepository is cluster-scoped</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> private</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">repo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">url</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> https</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain">//packages.example.com/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># auth is optional</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">auth</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># exactly one of the following auth methods must be provided. an empty auth block is invalid</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">basic</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># username and password can be specified directly or via secret.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># Both must be specified either directly or via secretRef</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># Any secret referenced here must be in the glasskube-system namespace</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">username</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> foo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">usernameSecretRef</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> private</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">repo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">auth</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">key</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> username</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">password</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> bar</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">passwordSecretRef</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> private</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">repo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">auth</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">key</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> password</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">bearer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">token</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> xxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token key atrule">tokenSecretRef</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> private</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">repo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">token</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token key atrule">key</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> token</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>A <code>Package</code> may reference a repository explicitly by its name.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> packages.glasskube.dev/v1alpha1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> Package</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> package</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">sample</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">packageInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> foo</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> v1.0.0+1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># repositoryName is optional</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">repositoryName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> private</span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain">repo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If a package does not specify a <code>repoName</code>, the default repository is used.
The default repository can be determined by getting all <code>PackageRepositories</code> with the <code>packages.glasskube.dev/defaultRepository=true</code> annotation.
If there is exactly one such <code>PackageRepositories</code>, use it as default.
If there are two or more such <code>PackageRepositories</code>, there is no default repository.</p>
<p>A <code>PackageRepository</code> can only be deleted if there are no packages installed using it.
This is also true for the default repository.
The default repository can only be changed if there are no packages installed from the default repository.
For now, these limitations are not enforced by a validating webhook, they will lead to a reconciliation error.
Installed packages do not break but can not be updated until the missing repository is re-created.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cli-design">CLI Design<a href="#cli-design" class="hash-link" aria-label="Direct link to CLI Design" title="Direct link to CLI Design">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="repository-management">Repository Management<a href="#repository-management" class="hash-link" aria-label="Direct link to Repository Management" title="Direct link to Repository Management">​</a></h4>
<ul>
<li><code>glasskube repo list</code> prints a list of installed repositories</li>
<li><code>glasskube repo add [name] [url]</code> creates a new repository<!-- -->
<ul>
<li><code>--default</code> toggles the <code>packages.glasskube.dev/defaultRepository=true</code> annotation. If there is a repository
with that annotation already, the default annotation will be removed for that repository</li>
<li><code>--auth=none</code> no authentication (default)</li>
<li><code>--auth=basic</code> enables basic authentication</li>
<li><code>--auth=bearer</code> enables token authentication</li>
<li><code>--username</code>, <code>--password</code> and <code>--token</code> set the auth credentials.<!-- -->
<ul>
<li>If <code>--username</code> or <code>--password</code> is specified, auth type &quot;basic&quot; can be inferred.</li>
<li>If <code>--token</code> is specified, auth type &quot;bearer&quot; can be inferred.</li>
</ul>
</li>
</ul>
</li>
<li><code>glasskube repo update [name]</code> creates a new repository<!-- -->
<ul>
<li>same flags as &quot;add&quot; plus the following</li>
<li><code>--auth=none</code> disable the authentication</li>
<li><code>--default</code> toggles the <code>packages.glasskube.dev/defaultRepository=true</code> annotation. If there is a repository
with that annotation already, the default annotation will be removed for that repository</li>
<li><code>--url</code> set the new url for the repository</li>
</ul>
</li>
<li><code>glasskube repo delete [name]</code> removes an installed repository</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="package-management">Package Management<a href="#package-management" class="hash-link" aria-label="Direct link to Package Management" title="Direct link to Package Management">​</a></h4>
<ul>
<li><code>glasskube install foo</code> checks all installed repositories for a package with name &quot;foo&quot;.<!-- -->
<ul>
<li>If no match: error</li>
<li>If 1 match: use that repo (show which one in the summary before confirmation)</li>
<li>if 2 or more match: Let the user choose</li>
</ul>
</li>
<li><code>glasskube install foo --repository=private-repo</code> uses the <code>PackageRepository</code> with name &quot;private-repo&quot;</li>
<li><code>glasskube update</code> uses the repo from the installed package</li>
<li><code>glasskube list</code> lists packages from all repositories.
The repositories each package is available from are shown in a new column.
If a package is installed and it is available from more than one repository, the one used in the installation is marked in this column with &quot;(used)&quot;
If a package is not installed and it is available from more than one repository, the latest version shown is the highes one available across repositories.</li>
<li><code>glasskube describe</code> shows the repositories the package is available from and the one that is used for installation.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ui-design">UI Design<a href="#ui-design" class="hash-link" aria-label="Direct link to UI Design" title="Direct link to UI Design">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="repository-management-1">Repository Management<a href="#repository-management-1" class="hash-link" aria-label="Direct link to Repository Management" title="Direct link to Repository Management">​</a></h4>
<p>Current UI of the new settings holds the package repository configuration.</p>
<img src="https://github.com/glasskube/glasskube/assets/3041752/e8565cf7-6089-4b82-b169-91f5b3ef4c33" alt="Glasskube UI Repo settings" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://github.com/glasskube/glasskube/assets/3041752/cf1f1983-78c8-4bb4-9d47-86dbf3a16c4e" alt="Glasskube UI Repo settings" class="themedComponent_mlkZ themedComponent--dark_xIcU">
<p>Adding and updating repositories is not yet supported via the UI.
(see <a href="https://github.com/glasskube/glasskube/issues/860" target="_blank" rel="noopener noreferrer">#860</a> and <a href="https://github.com/glasskube/glasskube/issues/861" target="_blank" rel="noopener noreferrer">#860</a>)</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="package-management-1">Package Management<a href="#package-management-1" class="hash-link" aria-label="Direct link to Package Management" title="Direct link to Package Management">​</a></h4>
<p>On the list page, packages from all installed repositories are shown.
If two or more repositories feature a package with the same name and that package is not installed, it is only shown once, where the iconUrl and shortDescription are taken from the first repository ordered alphabetically, that is not the default repository.</p>
<p>On the details page, if the package is not installed and featured in two or more repositories, there is a dropdown at the top of the page where a user can select the repository they want to install the package from.
When changing the dropdown value, the page is refreshed with data from the new selected repository.
All data shown comes from the selected repository.</p>
<p>If a package is already installed or only available from one repository, the dropdown is not shown.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="migration--compatibility">Migration &amp; Compatibility<a href="#migration--compatibility" class="hash-link" aria-label="Direct link to Migration &amp; Compatibility" title="Direct link to Migration &amp; Compatibility">​</a></h3>
<p>The <code>bootstrap</code> command creates a default repository in the cluster by default.
This repository has the name &quot;glasskube&quot; and repositoryUrl &quot;<a href="https://packages.dl.glasskube.dev/packages/" target="_blank" rel="noopener noreferrer">https://packages.dl.glasskube.dev/packages/</a>&quot;.
By creating this repository, we ensure that existing installations remain functional.
This behavior can be turned off by running <code>bootstrap</code> with <code>--create-default-repository=false</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="known-limitations">Known Limitations<a href="#known-limitations" class="hash-link" aria-label="Direct link to Known Limitations" title="Direct link to Known Limitations">​</a></h2>
<ul>
<li>If a package has a dependency that is available from more than one repository, the operator would have to decide which one to install.
This is not something we want to do!
Therefore, we treat this case as an error for now and ask the user to install the dependency manually, deciding which repository to use.
This will be better once we migrate to fully client-side dependency resolution.</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/glasskube/glasskube/tree/main/website/docs/05_design/repositories.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/TP2024-T5/docs/design/package-scopes/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Package Scopes</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/TP2024-T5/docs/design/telemetry/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Telemetry</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#problem-analysis" class="table-of-contents__link toc-highlight">Problem Analysis</a></li><li><a href="#proposed-solution" class="table-of-contents__link toc-highlight">Proposed Solution</a><ul><li><a href="#api-specification-and-operator" class="table-of-contents__link toc-highlight">API Specification and Operator</a></li><li><a href="#cli-design" class="table-of-contents__link toc-highlight">CLI Design</a></li><li><a href="#ui-design" class="table-of-contents__link toc-highlight">UI Design</a></li><li><a href="#migration--compatibility" class="table-of-contents__link toc-highlight">Migration &amp; Compatibility</a></li></ul></li><li><a href="#known-limitations" class="table-of-contents__link toc-highlight">Known Limitations</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Glasskube, Inc.<br>Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>