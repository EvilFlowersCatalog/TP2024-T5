<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-blog" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Glasskube GitOps template | Team 5</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://EvilFlowersCatalog.dev/TP2024-T5/blog/gitops-template/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Glasskube GitOps template | Team 5"><meta data-rh="true" name="description" content="A GitOps starter template to get started with ArgoCD &amp; Glasskube in seconds instead of hours"><meta data-rh="true" property="og:description" content="A GitOps starter template to get started with ArgoCD &amp; Glasskube in seconds instead of hours"><meta data-rh="true" property="og:image" content="https://github.com/user-attachments/assets/7ad482a7-c0a2-4081-8654-670f3cccb7cd"><meta data-rh="true" name="twitter:image" content="https://github.com/user-attachments/assets/7ad482a7-c0a2-4081-8654-670f3cccb7cd"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-08-07T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/christophenne/,https://github.com/jakepage91,https://www.linkedin.com/in/pmigat/"><meta data-rh="true" property="article:tag" content="glasskube,argocd,gitops,template"><link data-rh="true" rel="icon" href="/TP2024-T5/img/favicon.png"><link data-rh="true" rel="canonical" href="https://EvilFlowersCatalog.dev/TP2024-T5/blog/gitops-template/"><link data-rh="true" rel="alternate" href="https://EvilFlowersCatalog.dev/TP2024-T5/blog/gitops-template/" hreflang="en"><link data-rh="true" rel="alternate" href="https://EvilFlowersCatalog.dev/TP2024-T5/blog/gitops-template/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://EvilFlowersCatalog.dev/TP2024-T5/blog/gitops-template","mainEntityOfPage":"https://EvilFlowersCatalog.dev/TP2024-T5/blog/gitops-template","url":"https://EvilFlowersCatalog.dev/TP2024-T5/blog/gitops-template","headline":"Glasskube GitOps template","name":"Glasskube GitOps template","description":"A GitOps starter template to get started with ArgoCD & Glasskube in seconds instead of hours","datePublished":"2024-08-07T00:00:00.000Z","author":[{"@type":"Person","name":"Christoph Enne","description":"Software Engineer","url":"https://github.com/christophenne/","image":"https://avatars.githubusercontent.com/christophenne"},{"@type":"Person","name":"Jake Page","description":"Developer Relations Engineer","url":"https://github.com/jakepage91","image":"https://avatars.githubusercontent.com/jakepage91"},{"@type":"Person","name":"Philip Miglinci","description":"Co-Founder","url":"https://www.linkedin.com/in/pmigat/","image":"https://avatars.githubusercontent.com/pmig"}],"image":{"@type":"ImageObject","@id":"https://github.com/user-attachments/assets/7ad482a7-c0a2-4081-8654-670f3cccb7cd","url":"https://github.com/user-attachments/assets/7ad482a7-c0a2-4081-8654-670f3cccb7cd","contentUrl":"https://github.com/user-attachments/assets/7ad482a7-c0a2-4081-8654-670f3cccb7cd","caption":"title image for the blog post: Glasskube GitOps template"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://EvilFlowersCatalog.dev/TP2024-T5/blog","name":"Blog"}}</script><link rel="preconnect" href="https://a.glasskube.eu/">
<script>var _paq=window._paq=window._paq||[];_paq.push(["setRequestMethod","POST"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),_paq.push(["enableHeartBeatTimer"]),function(){var e="https://a.glasskube.eu/";_paq.push(["setRequestMethod","POST"]),_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","5"]);var a=document,t=a.createElement("script"),p=a.getElementsByTagName("script")[0];t.type="text/javascript",t.async=!0,t.src=e+"matomo.js",p.parentNode.insertBefore(t,p)}()</script>

<link rel="alternate" type="application/rss+xml" href="/TP2024-T5/blog/rss.xml" title="Team 5 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/TP2024-T5/blog/atom.xml" title="Team 5 Atom Feed">


<link rel="preconnect" href="https://p.glasskube.eu">
<script>!function(t,e){var o,s,r,a;e.__SV||(window.posthog=e,e._i=[],e.init=function(p,i,n){function c(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(r=t.createElement("script")).type="text/javascript",r.async=!0,r.src=i.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(a=t.getElementsByTagName("script")[0]).parentNode.insertBefore(r,a);var g=e;for(void 0!==n?g=e[n]=[]:n="posthog",g.people=g.people||[],g.toString=function(t){var e="posthog";return"posthog"!==n&&(e+="."+n),t||(e+=" (stub)"),e},g.people.toString=function(){return g.toString(1)+".people (stub)"},o="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled onFeatureFlags getFeatureFlag getFeatureFlagPayload reloadFeatureFlags group updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures getActiveMatchingSurveys getSurveys onSessionId".split(" "),s=0;s<o.length;s++)c(g,o[s]);e._i.push([p,i,n])},e.__SV=1)}(document,window.posthog||[]),posthog.init("phc_EloQUW6cgfbTc0pI9c5CXElhQ4gVGRoBsrUAoakJVoQ",{api_host:"https://p.glasskube.eu",ui_host:"https://eu.posthog.com",id:"default"})</script><link rel="stylesheet" href="/TP2024-T5/assets/css/styles.3a49a472.css">
<script src="/TP2024-T5/assets/js/runtime~main.89cb1c4c.js" defer="defer"></script>
<script src="/TP2024-T5/assets/js/main.ba36cd88.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/TP2024-T5/"><div class="navbar__logo"><img src="/TP2024-T5/img/glasskube-logo.svg" alt="Glasskube Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/TP2024-T5/img/glasskube-logo.svg" alt="Glasskube Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Team 5</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/TP2024-T5/blog/">Records</a><a class="navbar__item navbar__link" href="/TP2024-T5/docs/">Sprints</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><main><article class="container margin-vert--lg"><div class="row"><div class="col col--3"><div><div style="font-size:28px">Recent posts</div><div><a style="margin-top:20px" class="button button--outline" href="/TP2024-T5/blog/">View Recent posts</a></div></div></div><div class="col col--7"><header class="card__header"><h1 class="title_xvU1">Glasskube GitOps template</h1><div class="imageOnlyAuthorRow_lXe7"><div><div class="avatar"><a href="https://github.com/christophenne/" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/christophenne" alt="Christoph Enne"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/christophenne/" target="_blank" rel="noopener noreferrer"><span>Christoph Enne</span></a></div><small class="avatar__subtitle">Software Engineer</small></div></div></div><div><div class="avatar"><a href="https://github.com/jakepage91" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/jakepage91" alt="Jake Page"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://github.com/jakepage91" target="_blank" rel="noopener noreferrer"><span>Jake Page</span></a></div><small class="avatar__subtitle">Developer Relations Engineer</small></div></div></div><div><div class="avatar"><a href="https://www.linkedin.com/in/pmigat/" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/pmig" alt="Philip Miglinci"></a><div class="avatar__intro"><div class="avatar__name"><a href="https://www.linkedin.com/in/pmigat/" target="_blank" rel="noopener noreferrer"><span>Philip Miglinci</span></a></div><small class="avatar__subtitle">Co-Founder</small></div></div></div></div><div class="container_iJTo"><time datetime="2024-08-07T00:00:00.000Z">August 7, 2024</time> · <!-- -->10 min read</div></header><div id="__blog-post-container" class="markdown card__body"><p><img decoding="async" loading="lazy" src="https://github.com/user-attachments/assets/7ad482a7-c0a2-4081-8654-670f3cccb7cd" alt="thumbnail" class="img_ev3q"></p>
<p>We have all heard of writers looking at a blank page for hours trying to get over writer&#x27;s block. For Kubernetes admins, setting up a brand new Kubernetes cluster can be just as daunting. 
Especially when it involves configuring multiple elements like ArgoCD, a PostgreSQL database, monitoring tooling, and custom web apps.</p>
<p>However, what if there was an easier way? Our new GitOps template is designed to make this process straightforward and hassle-free. It offers an easy to set up solution that requires almost no manual steps for a basic yet highly extensible GitOps setup. With this template, you can have your cluster up and running quickly and efficiently, allowing you to focus on what matters most, building and scaling your applications.</p>
<p>If you’re reading this, you likely already appreciate the benefits of GitOps and have a solid understanding of Kubernetes. However, until recently, there hasn’t been an elegant, standardized process for managing the packages installed in your Kubernetes clusters. That’s why we built one.</p>
<p>Let’s put it to the test. With this template, ArgoCD, CloudNativePG and a simple bookmarking web app will be installed using the <a href="https://glasskube.dev/" target="_blank" rel="noopener noreferrer">Glasskube</a> Package Manager and they’ll receive upgrades through a Renovate integration via pull requests. This future-proof setup is easy to maintain and ensures your clusters stay up-to-date effortlessly.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-next-logical-extension-for-infrastructure-iac">The next logical extension for infrastructure IaC<a href="#the-next-logical-extension-for-infrastructure-iac" class="hash-link" aria-label="Direct link to The next logical extension for infrastructure IaC" title="Direct link to The next logical extension for infrastructure IaC">​</a></h3>
<p>There are clear frameworks, templates, and standards for provisioning infrastructure across almost all cloud providers, and even templates for provisioning Kubernetes clusters themselves. However, this is often where the smooth, paved Infrastructure as Code (IaC) road turns to gravel. Kubernetes admins are frequently left to their own devices to install, configure, and manage the packages within the Kubernetes cluster due to a lack of standardized and simple package management tooling.</p>
<p>Converting package configurations to code and managing them through GitOps, as you would with internal applications, has proven difficult. We believe the Glasskube package is a significant step toward the much-needed standardization in this area.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-a-glasskube-package">What is a Glasskube package?<a href="#what-is-a-glasskube-package" class="hash-link" aria-label="Direct link to What is a Glasskube package?" title="Direct link to What is a Glasskube package?">​</a></h3>
<p>A Glasskube package is a standardized unit for managing software deployments within Kubernetes clusters using the Glasskube Package Manager. It is defined by a <code>PackageManifest</code>, which contains all necessary information for identifying, configuring and installing a package. This manifest can include a Helm resource or a link to a manifest. Dependencies between packages can be declared, ensuring all required components are present before installation.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-argocd-to-deploy-glasskube-packages">Use ArgoCD to deploy Glasskube packages<a href="#use-argocd-to-deploy-glasskube-packages" class="hash-link" aria-label="Direct link to Use ArgoCD to deploy Glasskube packages" title="Direct link to Use ArgoCD to deploy Glasskube packages">​</a></h3>
<p>Helm charts or plain Kubernetes manifests lack the comprehensive framework that Glasskube packages offer for deploying resources declaratively in a reliable, consistent, and easily maintained way. In this demo, we’ll use the GitOps template to bootstrap a fresh Kubernetes cluster with an instance of ArgoCD, which will then be used to deploy all subsequent packages.</p>
<p>Here’s what the cluster will look like.</p>
<p><img decoding="async" loading="lazy" src="https://github.com/user-attachments/assets/4cbd8f2e-fd08-4380-80b7-1ebdb0a44860" alt="diagram-gif" class="img_ev3q"></p>
<p>Template diagram</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="template-structure">Template structure<a href="#template-structure" class="hash-link" aria-label="Direct link to Template structure" title="Direct link to Template structure">​</a></h3>
<blockquote>
<p><em>🔗 Link to</em> <a href="https://github.com/glasskube/gitops-template" target="_blank" rel="noopener noreferrer"><em>template</em></a></p>
</blockquote>
<p>The repository contains:</p>
<ul>
<li>a <code>bootstrap</code> directory containing the initial/parent Argo Application, and the necessary Glasskube manifests.</li>
<li>a <code>packages</code> directory containing the <code>ArgoCD</code> ,<code>cloudnative-pg</code> and <code>kube-prometheus-stack</code> cluster packages.</li>
<li>an <code>apps</code> folder containing a simple <code>shiori</code> bookmarking web app. </li>
<li>the <code>renovate</code> configuration file.</li>
</ul>
<p>Glasskube custom resources will only be picked up by ArgoCD after placing the package definition files inside the <code>packages</code> directory.</p>
<blockquote>
<p><em>⚠️ Please do not delete/uninstall the argo-cd package, as this will also remove everything else!</em></p>
</blockquote>
<p>Note that the parent application used to bootstrap (bootstrap/glasskube-application.yaml) will not be synced after the initial setup. If you want to change something about it, you will have to change the application via argo directly.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cluster-setup">Cluster setup<a href="#cluster-setup" class="hash-link" aria-label="Direct link to Cluster setup" title="Direct link to Cluster setup">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h4>
<p>You will have to have access to an empty Kubernetes cluster.</p>
<p>The easiest would be creating a new Minikube cluster with:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">minikube start -p glasskube</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p><em>⚠️ Glasskube should</em> <strong><em>not yet be bootstrapped</em></strong> <em>in the cluster.</em></p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-the-glasskube-cli">Install the Glasskube CLI<a href="#install-the-glasskube-cli" class="hash-link" aria-label="Direct link to Install the Glasskube CLI" title="Direct link to Install the Glasskube CLI">​</a></h3>
<p>Make sure to have at least Glasskube version 0.16.0 <a href="https://glasskube.dev/docs/getting-started/install/" target="_blank" rel="noopener noreferrer">installed</a> locally. If you don’t, you can simply run:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">brew install glasskube/tap/glasskube</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-use-thetemplate">How to use the template<a href="#how-to-use-thetemplate" class="hash-link" aria-label="Direct link to How to use the template" title="Direct link to How to use the template">​</a></h3>
<p>Use <a href="https://github.com/glasskube/gitops-template" target="_blank" rel="noopener noreferrer">this</a> repository as your GitOps template</p>
<p>Create a public GitHub repository based on this starter template by clicking “Use this template“. You can move it and/or make it private afterward.</p>
<p>Replace the placeholder <strong>repoURL</strong> in your local GitOps repository</p>
<p>Replace the default value of <code>repoURL</code> to your repository url:</p>
<ul>
<li>Line 12 in: <code>bootstrap/glasskube-application.yaml</code></li>
<li>Lines 11, 16 and 26 in: <code>bootstrap/glasskube/applicationset.yaml</code></li>
</ul>
<p>Bootstrap ArgoCD and Glasskube for your Kubernetes cluster:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">glasskube bootstrap git --url &lt;your-repo&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-result">The result<a href="#the-result" class="hash-link" aria-label="Direct link to The result" title="Direct link to The result">​</a></h3>
<p>As a result, your cluster will be powered with GitOps capabilities by ArgoCD, as well as package management features by Glasskube. Argo manages itself, the Glasskube installation, as well as Glasskube packages — all of which you can now manage GitOps-style with this repo.</p>
<p>Run <code>glasskube serve</code> to open the Glasskube UI and either open the ArgoCD UI there, or with the command glasskube open argo-cd – but of course you can also use the Argo CLI. Follow the <a href="https://argo-cd.readthedocs.io/en/stable/getting_started/#4-login-using-the-cli" target="_blank" rel="noopener noreferrer">ArgoCD docs</a> to get and reset the password to log in.</p>
<blockquote>
<p><em>💡 Note that it might take a couple of minutes to start up ArgoCD, and for the initial GitOps sync to happen.</em></p>
</blockquote>
<p>In this template, for demonstration purposes we’ve also installed the <code>cloudnative-pg</code> and <code>kube-prometheus-stack</code>clusterpackages and a bookmarking application (<a href="https://github.com/go-shiori/shiori" target="_blank" rel="noopener noreferrer">shiori</a>), which is making use of cloudnative-pg.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="managing-yourcluster">Managing your cluster<a href="#managing-yourcluster" class="hash-link" aria-label="Direct link to Managing your cluster" title="Direct link to Managing your cluster">​</a></h3>
<p>Both CLI and UI offer features to manage your cluster following GitOps best practices.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="using-thecli">Using the CLI<a href="#using-thecli" class="hash-link" aria-label="Direct link to Using the CLI" title="Direct link to Using the CLI">​</a></h4>
<p>The relevant CLI commands offer the flags <code>--dry-run</code> and <code>-o yaml</code> which output the yaml object code which should then be pushed to your repository to be deployed.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="through-theui">Through the UI<a href="#through-theui" class="hash-link" aria-label="Direct link to Through the UI" title="Direct link to Through the UI">​</a></h4>
<p>The UI, when installed with the above <code>glasskube bootstrap git</code> command, will also output the <code>yaml</code> objects which you can copy to use in your git repo, instead of applying your changes directly.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="installing-packages">Installing packages<a href="#installing-packages" class="hash-link" aria-label="Direct link to Installing packages" title="Direct link to Installing packages">​</a></h3>
<p>To install a ClusterPackage, e.g. cert-manager, use the install command like this:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">glasskube install cert-manager --dry-run -o yaml --yes &gt; cert-manager.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Instead of directly installing the <code>ClusterPackage</code>, this will write the <code>ClusterPackage</code> custom resource to the <code>cert-manager.yaml file</code>, which can now be put into a new directory <code>packages/cert-manager/</code> in the git repository. Once pushed to the repo, ArgoCD will pick up the changes after at most 5 minutes, create the ArgoCD Application wrapping the Glasskube <code>ClusterPackage</code>. After that, the Glasskube operator will pick up the <code>ClusterPackage</code> and finally install it in the cluster.</p>
<p>Similarly, when using the Glasskube UI, one can generate the ClusterPackage resource by using the “Show YAML” button on the page of the ClusterPackage.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="updating-packages">Updating packages<a href="#updating-packages" class="hash-link" aria-label="Direct link to Updating packages" title="Direct link to Updating packages">​</a></h3>
<p>There are two options handling package version updates:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="manually">Manually<a href="#manually" class="hash-link" aria-label="Direct link to Manually" title="Direct link to Manually">​</a></h4>
<p>Using the <code>glasskube update --dry-run -o yaml</code> command, or the corresponding button on the Glasskube UI. And then pushing to your repo as seen before. 
The downside of doing it that way, is that someone has to manually execute the command, even though checking for updates and preparing the updates to the git repository as an automatable task.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="automatically-with-renovate">Automatically with Renovate<a href="#automatically-with-renovate" class="hash-link" aria-label="Direct link to Automatically with Renovate" title="Direct link to Automatically with Renovate">​</a></h4>
<p>Once Renovate is <a href="https://github.com/renovatebot/renovate" target="_blank" rel="noopener noreferrer">integrated</a> to track your GitOps repo, it will look for Glasskube packages and compare their versions to the official package repositories. When new versions are available, it will automatically open a PR. Once merged, you’ll be running the latest versions of your packages.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="uninstalling-packages">Uninstalling packages<a href="#uninstalling-packages" class="hash-link" aria-label="Direct link to Uninstalling packages" title="Direct link to Uninstalling packages">​</a></h3>
<p>To uninstall a package or a <code>ClusterPackage</code>, simply remove the custom resource from the git repository.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="updating-glasskube">Updating Glasskube<a href="#updating-glasskube" class="hash-link" aria-label="Direct link to Updating Glasskube" title="Direct link to Updating Glasskube">​</a></h3>
<p>When a new Glasskube version is available, the manifests have to be updated. To update the Glasskube manifests in your git repo, run the following command:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">glasskube bootstrap --dry-run -o yaml --force &gt; bootstrap/glasskube/glasskube.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After reviewing and merging those changes the update will be picked up by ArgoCD. The <code>--force</code> flag is necessary for the command to continue manifest validation, even though failures occur.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="working-with-apps">Working with Apps<a href="#working-with-apps" class="hash-link" aria-label="Direct link to Working with Apps" title="Direct link to Working with Apps">​</a></h3>
<p>This template also contains a demo application: a bookmark manager called <a href="https://github.com/go-shiori/shiori" target="_blank" rel="noopener noreferrer">shiori</a>.
Its manifests are defined in <code>apps/shiori</code>, which is a pattern you can follow for your own custom applications.</p>
<p>In a minikube environment, two manual steps are required to access the application (for more information consult the
<a href="https://kubernetes.io/docs/tasks/access-application-cluster/ingress-minikube/" target="_blank" rel="noopener noreferrer">minikube docs</a>):</p>
<ul>
<li>Run <code>minikube addons enable ingress -p gitops</code>.</li>
<li>Run <code>minikube ip -p gitops</code> and add the line <code>&lt;your-IP&gt; my-shiori.example</code> to your <code>/etc/hosts</code> file.</li>
</ul>
<p>After that you will be able to access the application via <a href="http://my-shiori.example" target="_blank" rel="noopener noreferrer">http://my-shiori.example</a> in your browser.
The default login credentials are <code>shiori</code> / <code>gopher</code> – for more information check the <a href="https://github.com/go-shiori/shiori/tree/master/docs" target="_blank" rel="noopener noreferrer">shiori docs</a>.</p>
<p>In general, you can use the <code>apps</code> directory to deploy such custom applications into your cluster. Any subdirectory will be
picked up by ArgoCD and grouped as an <code>Application</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-with-kube-prometheus-stack">Monitoring with <code>kube-prometheus-stack</code><a href="#monitoring-with-kube-prometheus-stack" class="hash-link" aria-label="Direct link to monitoring-with-kube-prometheus-stack" title="Direct link to monitoring-with-kube-prometheus-stack">​</a></h3>
<p>This template also installs the <code>kube-prometheus-stack</code> clusterpackage, which is an easy way to get started with monitoring your cluster. You can open Grafana with <code>glasskube open kube-prometheus-stack</code>. It does not come preconfigured in this example, but you can easily add a nice postgres dashboard and observe the metrics of the database while you are working with the bookmarking application.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-a-postgres-dashboard">Setting up a postgres dashboard<a href="#setting-up-a-postgres-dashboard" class="hash-link" aria-label="Direct link to Setting up a postgres dashboard" title="Direct link to Setting up a postgres dashboard">​</a></h4>
<p>We are going to make use of the <a href="https://grafana.com/grafana/dashboards/20417-cloudnativepg/" target="_blank" rel="noopener noreferrer">cloudnativepg dashboard</a>.
Import it by opening the <a href="http://localhost:8888/dashboard/import" target="_blank" rel="noopener noreferrer">dashboard-import page</a>, pasting
<a href="https://grafana.com/grafana/dashboards/20417-cloudnativepg/" target="_blank" rel="noopener noreferrer">https://grafana.com/grafana/dashboards/20417-cloudnativepg/</a>
into the first textfield, and pressing &quot;Load&quot;. Use the &quot;Prometheus&quot; data source on the following screen and finish the import process.</p>
<p><img decoding="async" loading="lazy" src="https://github.com/user-attachments/assets/d54dcefe-535c-4812-bd80-486558f6caa4" alt="CloudNativePG dashboard" class="img_ev3q"></p>
<p>Of course monitoring your experimental minikube cluster is a bit of an overkill, but this is simply to demonstrate how these kind of cluster administration tasks can be integrated into this gitops stack.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="template-setup-walkthrough">Template setup walkthrough<a href="#template-setup-walkthrough" class="hash-link" aria-label="Direct link to Template setup walkthrough" title="Direct link to Template setup walkthrough">​</a></h3>
<div style="display:flex;justify-content:center;align-items:center"><iframe width="100%" height="460" src="https://www.youtube-nocookie.com/embed/Xbs2Tq-dgbI?si=PfrhS5g0ZVq-YDCi" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"></iframe></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="upcoming-features">Upcoming Features<a href="#upcoming-features" class="hash-link" aria-label="Direct link to Upcoming Features" title="Direct link to Upcoming Features">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="private-reposupport">Private Repo Support<a href="#private-reposupport" class="hash-link" aria-label="Direct link to Private Repo Support" title="Direct link to Private Repo Support">​</a></h4>
<p>We are aware that GitOps repositories should not be public, but for simplicity we omitted this feature in the first version of the new GitOps-bootstrap command. Supporting private repos with authentication of course has high priority for the upcoming releases. We will also replace the <code>repoURL</code> automatically, such that you don’t need to this step manually when setting up the repo.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="improved-renovate-integration">Improved Renovate Integration<a href="#improved-renovate-integration" class="hash-link" aria-label="Direct link to Improved Renovate Integration" title="Direct link to Improved Renovate Integration">​</a></h4>
<p>As described above, the renovate integration currently is regex-based, and it does not consider dependencies yet. However, we don’t see these shortcomings as a blocker and recommend to try out the renovate integration in the Glasskube/Argo Gitops setup.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="improved-dependency-resolution">Improved Dependency Resolution<a href="#improved-dependency-resolution" class="hash-link" aria-label="Direct link to Improved Dependency Resolution" title="Direct link to Improved Dependency Resolution">​</a></h4>
<p>Installing packages with dependencies is not 100% GitOps-compatible yet, as the dependencies will be created by the operator. Consider this: To install a <code>ClusterPackage &lt;P&gt;</code> that has a dependency on <code>D</code>, one would do <code>glasskube install &lt;P&gt; --dry-run -o yaml</code>, which would output the <code>ClusterPackage</code> custom resource for <code>&lt;P&gt;</code>. However, the dependency <code>D</code> will only be resolved at reconciliation time by the package operator, and will therefore not be represented in the git repository at all.</p>
<p>A temporary workaround would be to have a closer look at the output of the install command, which also shows the dependencies which will be installed and in which version. One could then manually add the required packages custom resources to the git repo as well. However, this will be tackled in a future version to make the user experience better, see this <a href="https://github.com/glasskube/glasskube/issues/430" target="_blank" rel="noopener noreferrer">issue</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">​</a></h2>
<p>With this template repository and guide we show how Glasskube can easily be set up in a ArgoCD powered Gitops environment,
and how efficient package management is possible with this stack. Additionally we install a web application to show how
custom applications can make use of the Gitops setup and Glasskube packages.</p>
<p>This is a first concept with some minor shortcomings, but we will continue to improve GitOps support.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="feedback">Feedback<a href="#feedback" class="hash-link" aria-label="Direct link to Feedback" title="Direct link to Feedback">​</a></h3>
<p>We love feedback! Whether you are just starting out or you are a seasoned professional, we&#x27;d like to hear your thoughts, inputs and questions
regarding this starter template and corresponding guide here, in the <a href="https://github.com/glasskube/glasskube" target="_blank" rel="noopener noreferrer">glasskube/glasskube repo</a> or on
our <a href="https://discord.gg/SxH6KUCGH7" target="_blank" rel="noopener noreferrer">Discord</a>. Thanks!</p></div><footer class="docusaurus-mt-lg card__footer"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/TP2024-T5/blog/tags/glasskube/">glasskube</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/TP2024-T5/blog/tags/argocd/">argocd</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/TP2024-T5/blog/tags/gitops/">gitops</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/TP2024-T5/blog/tags/template/">template</a></li></ul></div></div></footer></div><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-next-logical-extension-for-infrastructure-iac" class="table-of-contents__link toc-highlight">The next logical extension for infrastructure IaC</a></li><li><a href="#what-is-a-glasskube-package" class="table-of-contents__link toc-highlight">What is a Glasskube package?</a></li><li><a href="#use-argocd-to-deploy-glasskube-packages" class="table-of-contents__link toc-highlight">Use ArgoCD to deploy Glasskube packages</a></li><li><a href="#template-structure" class="table-of-contents__link toc-highlight">Template structure</a></li><li><a href="#cluster-setup" class="table-of-contents__link toc-highlight">Cluster setup</a></li><li><a href="#install-the-glasskube-cli" class="table-of-contents__link toc-highlight">Install the Glasskube CLI</a></li><li><a href="#how-to-use-thetemplate" class="table-of-contents__link toc-highlight">How to use the template</a></li><li><a href="#the-result" class="table-of-contents__link toc-highlight">The result</a></li><li><a href="#managing-yourcluster" class="table-of-contents__link toc-highlight">Managing your cluster</a></li><li><a href="#installing-packages" class="table-of-contents__link toc-highlight">Installing packages</a></li><li><a href="#updating-packages" class="table-of-contents__link toc-highlight">Updating packages</a></li><li><a href="#uninstalling-packages" class="table-of-contents__link toc-highlight">Uninstalling packages</a></li><li><a href="#updating-glasskube" class="table-of-contents__link toc-highlight">Updating Glasskube</a></li><li><a href="#working-with-apps" class="table-of-contents__link toc-highlight">Working with Apps</a></li><li><a href="#monitoring-with-kube-prometheus-stack" class="table-of-contents__link toc-highlight">Monitoring with <code>kube-prometheus-stack</code></a></li><li><a href="#template-setup-walkthrough" class="table-of-contents__link toc-highlight">Template setup walkthrough</a></li><li><a href="#upcoming-features" class="table-of-contents__link toc-highlight">Upcoming Features</a></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a><ul><li><a href="#feedback" class="table-of-contents__link toc-highlight">Feedback</a></li></ul></li></ul></div></div></div></article></main><nav class="container margin-vert--lg" aria-label="Blog post page navigation"><div class="row"><div class="col col--3"></div><div class="row col col--7"><div class="col"><a class="pagination-nav__link pagination-nav__link--prev" href="/TP2024-T5/blog/launch-week-number-2/"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Launch week 2 - A new frontier of Kubernetes package management</div></a></div><div class="col"><a class="pagination-nav__link pagination-nav__link--next" href="/TP2024-T5/blog/series-a-idp/"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Why integrating an IDP for Series A companies doesn&#x27;t make sense</div></a></div></div></div></nav></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Glasskube, Inc.<br>Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>